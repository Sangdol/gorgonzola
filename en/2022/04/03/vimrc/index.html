<!DOCTYPE html>
<html lang="en-us">
<head>
    <title>Learnings after 500 commits to my vimrc | Sanghyun Lee</title>
        <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="index,follow">
    <meta name="description" content="I am Sang">
    <meta name="twitter:title" content="Learnings after 500 commits to my vimrc" />
    <meta name="twitter:description" content="I am Sang" />
    <meta name="twitter:creator" content="@sangdolha" />
    <meta name="twitter:card" content="summary_large_image">

    <meta name="twitter:image" content="https://iamsang.com/img/vimrc.png" />
    
    <meta property="og:image" content="https://iamsang.com/img/vimrc.png" />
    

    <link rel="shortcut icon" type="image/png" href="/icon-192x192.png">
    <link rel="shortcut icon" sizes="192x192" href="/icon-192x192.png">
    <link rel="apple-touch-icon" href="/icon-192x192.png">

    <link rel="manifest" href="/site.webmanifest">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/highlight.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      document.querySelectorAll('pre code').forEach((block) => {
        hljs.highlightBlock(block);
      });
    });
    </script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500">
    <link href="/css/normalize.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/sakura.css">
    <link href="/css/custom.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
            h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
            (a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
            })(window,document.documentElement,'async-hide','dataLayer',4000,
            {'GTM-PGRQWF8':true});
    </script>
    <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-23501808-2', 'auto');
          ga('require', 'GTM-PGRQWF8');
          ga('send', 'pageview');
    </script>

</head>
<body>
    <section class="top">
        <nav class="nav">
            <a href="/"><span>Home</span></a>
            <a href="/en"><span>Blog</span></a>
            <a href="/en-about"><span>About</span></a>
            <a href="https://twitter.com/iamsangcom"><span>Twitter</span></a>
        </nav>
    </section>
    <hr class="top-line">
    <section class="header">
        <div class="container">
            <div class="content">
                <div class="name">
                    <span class="colored" style="font-weight:100">I am</span>
                    Sang
                </div>
            </div>
        </div>
    </section>

<div class="container article">
    <div class="page-heading">Learnings after 500 commits to my vimrc</div>
    <p>Last winter on a Saturday, I decided to tweak <a href='https://github.com/Sangdol/vimrc/'>my vimrc</a>. I've been putting it off for a long time since I felt spending time on improving and cleaning up vimrc was too luxurious. I thought it'd be fun but it wouldn't pay back the time that I'd invest.</p><p><img src="https://iamsang.com/img/vimrc.png" alt="vimrc comic" /></p><p>This time I determined to do myself a favor and enjoy spending a day or two working on my vimrc.</p><p>I ended up spending more than three months and making around 500 commits to my vimrc. I still work on it from time to time.</p><p>It was a fun and frustrating journey and I'd like to share what I've learned along the way and how happy I am now.</p><h3 id="table&#95;of&#95;contents">Table of Contents</h3><ul><li><a href='#what_i_have_done'>What I have done</a><ul><li><a href='#books'>Books</a></li><li><a href='#vimrcs'>vimrcs</a></li><li><a href='#vimscript'>vimscript</a></li></ul></li><li><a href='#how_to_troubleshoot_vim_and_plugins'>How to troubleshoot vim and plugins</a><ul><li><a href='#showing_error_messages_with_message'>Showing error messages with <code>:message</code></a></li><li><a href='#binary_search_to_find_a_problematic_plugin_or_code'>Binary search to find a problematic plugin or code</a></li><li><a href='#git_bisect_to_find_a_problematic_commit'><code>git bisect</code> to find a problematic commit</a></li><li><a href='#reading_plugin_documentation'>Reading plugin documentation</a></li><li><a href='#advanced_customizing_plugin_code'>(Advanced) customizing plugin code</a></li><li><a href='#searching_for_help'>Searching for help</a></li></ul></li><li><a href='#improved_productivity'>Improved Productivity</a><ul><li><a href='#using_vim_as_a_file_manager_with_fzf_and_nvim_tree'>Using vim as a File Manager with <code>fzf</code> and <code>nvim&#95;tree</code></a></li><li><a href='#nvim_terminal_as_tmux'>nvim terminal as <code>tmux</code></a></li><li><a href='#git'>Git</a></li></ul></li><li><a href='#next_steps'>Next Steps</a></li></ul><h3 id="what&#95;i&#95;have&#95;done">What I have done</h3><p>I started by deleting unused plugins and configuration. I didn't mean to spend so much time on this but once I got started I couldn't stop. Understanding how things work and improving my daily workflows with new knowledge was so fun and exciting.</p><h4 id="books">Books</h4><p>I looked for plugins to fix and improve a few things that were bothering me. Then I wanted to understand help pages and plugin READMEs so I started checking out books:</p><ul><li><a href='https://www.oreilly.com/library/view/learning-the-vi/9781492078791/'>Learning the vi and Vim Editors, 8th Edition</a>,</li><li><a href='https://learning.oreilly.com/library/view/practical-vim-2nd/9781680501629/'>Practical Vim, 2nd Edition</a>,</li><li><a href='https://learning.oreilly.com/library/view/modern-vim/9781680506006/'>Modern Vim</a>,</li><li><a href='https://learning.oreilly.com/library/view/mastering-vim/9781789341096/'>Mastering Vim</a>, and</li><li><a href='https://learning.oreilly.com/library/view/the-viml-primer/9781680500585/'>The VimL Primer</a>.</li></ul><p><i>Learning the vi and Vim Editors, 8th Edition</i> was good to brush up on my vim skills and <i>The VimL Primer</i> was easy and nice to read to learn vimscript.</p><p>I was able to access all the books freely thanks to the <a href='https://www.oreilly.com/'>O'Reilly membership</a> that <a href='https://jobs.zalando.com/de/'>my employer</a> provided me.</p><p>I read needed chapters instead of reading the books cover to cover. Reading books with the membership feels like using a music streaming service instead of buying CDs.</p><h4 id="vimrcs">vimrcs</h4><p>I read a few awesome guys' vimrcs such as</p><ul><li><a href='https://github.com/junegunn/dotfiles/blob/master/vimrc'>Junegunn</a>, who wrote <a href='https://github.com/junegunn/vim-plug'>Plug</a> and <a href='https://github.com/junegunn/fzf.vim'>fzf</a>, and</li><li><a href='https://github.com/wookayin/dotfiles/'>wookayin</a>, who wrote <a href='https://github.com/wookayin/gpustat'>gpustat</a> and happens to be my former co-worker.</li></ul><p>I learned enormous amount of things from the books and vimrcs but I often had to read lots of help pages and Stack Overflow threads to achieve what I want.</p><h4 id="vimscript">vimscript</h4><p>Vimscript is not that hard once you're good with vim.</p><p>When I learn a new programming language I start writing tests with it. This is called Test-Driven Learning.</p><p>Writing test code is a good way to learn a programming language because</p><ol><li>You learn the testing framework of a language in the early stage.</li><li>You learn by writing working code.</li><li>You have working documentation.</li></ol><p><a href='https://github.com/junegunn/vader.vim'>Vader</a> is a vimscript testing framework that is written by Junegunn. This is my Test-Driven Learning project using Vader (<a href='https://github.com/Sangdol/vimscript-test-driven-learning'>Github project</a>).</p><p>With this knowledge I wrote <a href='https://github.com/Sangdol/vimrc/blob/master/vim/rc/functions.vim'>functions for my vimrc</a> and customized plugins.</p><p>I also wrote a vim plugin <a href='https://github.com/Sangdol/mintabline.vim/'>Mintabline</a> to solve a problem that neovim doesn't show the tabline properly for terminal buffers.</p><p>I feel powerful after learning vimscript.</p><h3 id="how&#95;to&#95;troubleshoot&#95;vim&#95;and&#95;plugins">How to troubleshoot vim and plugins</h3><p>I used to spend hours and days or even weeks to find out the reason of an issue but now It takes no more than 30 minutes after I learned the things that I'll introduce here.</p><p>Knowing how to fix vim issues is the key to utilizing vim to its full power. I used to keep my plugin list lean to avoid randomly happening errors and slowness. I often didn't know where I should start to troubleshoot a problem.</p><p>For the past few months, I've tried tens of plugins and faced loads of issues. It sometimes took a few weeks to resolve an issue.</p><p>Vim plugins are powerful since they can directly control vim without having to reside in a sandbox or a container but due to this, it could be incredibly hard to debug an issue since a problem often doesn't provide any clue.</p><h4 id="showing&#95;error&#95;messages&#95;with&#95;<code>:message</code>">Showing error messages with <code>:message</code></h4><p>The first thing you should do when you face an issue is to read error messages carefully. But an error message could quickly disappear when you do some actions. You can use the <code>:message</code> command to bring the message back.</p><p>But, it's not possible to easily copy the message or have it open while troubleshooting. With this function, you can load messages into a buffer (<a href='https://vim.fandom.com/wiki/Append_output_of_an_external_command'>source wiki</a>).</p><pre><code class="vim">function! TabMessage&#40;cmd&#41;
  redir =&gt; message
  silent execute a:cmd
  redir END
  if empty&#40;message&#41;
    echoerr &quot;no output&quot;
  else
    tabnew
    setlocal buftype=nofile bufhidden=wipe noswapfile nobuflisted nomodified
    silent put=message
  endif
endfunction

command! -nargs=+ -complete=command TabMessage call TabMessage&#40;&lt;q-args&gt;&#41;
</code></pre><p>Once you have the code in your vimrc you can open a buffer with messages like this:</p><pre><code class="vim">:TabMessage message
</code></pre><p>or simply<pre><code class="vim">:TabMessage mes
</code></pre></p><h4 id="binary&#95;search&#95;to&#95;find&#95;a&#95;problematic&#95;plugin&#95;or&#95;code">Binary search to find a problematic plugin or code</h4><p>You can try a manual binary search when it's not possible to find the root cause by just reading error messages which is usually the case.</p><p>With this approach, you search for problematic code by commenting out plugins, functions, or options. In the process, you can comment out half of the code at a time to make it efficient.</p><p>To make this task even easier, I've modularized my vimrc (<a href='https://github.com/Sangdol/vimrc/blob/master/vimrc'>code link</a>).</p><p><img src="https://iamsang.com/img/vimrc-diagram.png" alt="vimrc diagram" /></p><p>With this structure, I can easily turn on and off a specific module.</p><p>These would be steps to debug:</p><ol><li>Disable modules or codes by deleting or commenting them out.</li><li>Run vim (in a separate terminal or window).</li><li>See if it's fixed.</li><li>Go to Step 1 if it's not fixed.</li></ol><p>You can take this approach whenever there's no clue which is often the case with CSS.</p><p><img src="https://iamsang.com/img/binary-search-in-practice-en.png" alt="binary search in practice comic" /></p><h4 id="<code>git&#95;bisect</code>&#95;to&#95;find&#95;a&#95;problematic&#95;commit"><code>git bisect</code> to find a problematic commit</h4><p><code>git bisect</code> is another way to do a binary search to pinpoint the cause of an issue.</p><p>It works like this:</p><pre><code class="sh"># Start `git bisect`
$ git bisect start

# Mark the current commit is bad
$ git bisect bad

# Say 100 commits ago it was good
$ git bisect good HEAD&#126;100

# Git starts bisecting.
# Run vim and see if the current commit it good.
$ git bisect good

# Run this until git pinpoints the problematic commit.
$ git bisect bad

# Finish `git bisect`:
$ git bisect reset
</code></pre><p>It takes only 7 trials for 100 commits (<code>math.log&#40;100, 2&#41; ≈ 6.65</code>).</p><h4 id="reading&#95;plugin&#95;documentation">Reading plugin documentation</h4><p>You found out the plugin that is causing an issue but don't know why.</p><p>You can first try:</p><ol><li>Checking out the vim help document of the plugin and see if it has relevant information. But, not all plugins have a help document.</li><li>Visiting the GitHub page of the plugin and see if there are any related issues.</li></ol><p>To open the GitHub page of a Plug line easily I use these functions.</p><pre><code class="vim">function! s:open&#95;url&#40;url&#41;
  echom 'Opening &quot;' .. a:url .. '&quot;'
  if !empty&#40;a:url&#41;
    if has&#40;&quot;mac&quot;&#41;
      exec &quot;!open '&quot;..a:url..&quot;'&quot;
    elseif has&#40;&quot;unix&quot;&#41;
      exec &quot;!google-chrome '&quot;..a:url..&quot;'&quot;
    endif
  else
    echom &quot;No URL found&quot;
  endif
endfunction

function! s:browser&#40;&#41;
  let line = getline&#40;'.'&#41;
  let line = trim&#40;line&#41;
  let is&#95;plug = StartsWith&#40;line, 'Plug'&#41;
  if is&#95;plug
    let path = substitute&#40;line, '\vPlug &#91;''&quot;&#93;&#40;.{-}&#41;&#91;''&quot;&#93;.&#42;', '\1', ''&#41;
    let url = 'https://github.com/' .. path
    call s:open&#95;url&#40;url&#41;
  else
    &quot; The regex for URLs is customized for my use cases. &quot;
    let line = matchstr&#40;line, &quot;http&#91;&#94; `&#41;&#93;&#42;&quot;&#41;
    let url = escape&#40;line, &quot;#;|%&quot;&#41;
    call s:open&#95;url&#40;url&#41;
  endif
endfunction

nnoremap &lt;Leader&gt;b :call &lt;SID&gt;browser&#40;&#41;&lt;CR&gt;&lt;CR&gt;
</code></pre><p>For example, if you run the <code>s:browser&#40;&#41;</code> function on this line, it'll open the GitHub page of the plugin in the browser.<pre><code class="vim">Plug 'junegunn/fzf.vim'
</code></pre></p><h4 id="(advanced)&#95;customizing&#95;plugin&#95;code">(Advanced) customizing plugin code</h4><p>If you can't find any meaningful information from documentation, you can check out the plugin code. A vim package manager downloads plugin files into your machine so it's easy to explore the files.</p><p>I do this often so I have a mapping to find installed plugin files quickly with fzf:</p><pre><code class="vim">nnoremap &lt;leader&gt;fpl :FZF &#126;/.vim/plugged&lt;CR&gt;
</code></pre><p>You can try fixing the issue directly in the downloaded files and see if it's fixed by reloading plugins or rerunning vim.</p><p>I sometimes had to fix issues only for my environment. For example, I found out that the <a href='https://github.com/moll/vim-bbye'>vim-bbye</a> plugin and the <a href='https://github.com/Asheq/close-buffers.vim'>close-buffer</a> plugin conflict with each other but I wanted to use both. I <a href='https://github.com/Sangdol/vim-bbye'>forked vim-bbye</a> and just deleted the conflicting code.</p><h4 id="searching&#95;for&#95;help">Searching for help</h4><p>Lastly, you can look for help in a few places such as</p><ul><li>GitHub</li><li>Discord</li><li>Gitter</li><li>Stack Overflow</li></ul><p>I once struggled with an issue with <a href='https://github.com/Olical/conjure'>Conjure</a>. I thought asking and waiting for an answer would take too long but it turned out that it's a quicker way to solve the issue.</p><p>Looking for a Discord community is another way. I use <a href='https://github.com/scalameta/coc-metals'>coc-metals</a> to write Scala and was able to get help from <a href='https://discord.gg/mZkhURPznE'>the Discord server</a>. I don't</p><p>There are awesome plugin maintainers out there.</p><p>Stack Overflow can be helpful as well. Once I even found out the answer to my issue while writing a question.</p><h3 id="improved&#95;productivity">Improved Productivity</h3><p>I once made a joke saying that I'll reach a break-even point for the time investment that I made if I write code until 80. That's an exaggeration but it'll take a long time if I only calculate the saved seconds to recover the time investment.</p><p>But, <a href='https://www.johndcook.com/blog/2015/12/22/automate-to-save-mental-energy-not-time/'>we automate things not to save time but to save mental energy</a>. I can try many more things with the same time and energy, and that significantly reduces problem-solving time.</p><p>And, I'm going to write code until after 80 anyway.</p><h4 id="using&#95;vim&#95;as&#95;a&#95;file&#95;manager&#95;with&#95;<code>fzf</code>&#95;and&#95;<code>nvim-tree</code>">Using vim as a File Manager with <code>fzf</code> and <code>nvim-tree</code></h4><p>I've tried file managers like <a href='https://github.com/ranger/ranger'>ranger</a> and <a href='https://github.com/gokcehan/lf'>lf</a> but I ended up not using them due to small issues.</p><p>After I started using vim as a file manager with <a href='https://github.com/junegunn/fzf.vim'>fzf</a> and <a href='https://github.com/kyazdani42/nvim-tree.lua'>nvim-tree</a>, I realized that this is the file manager that I've been looking for. I can move around and search for tens of projects easily.</p><p><iframe id="reddit-embed" src="https://www.redditmedia.com/r/neovim/comments/ph7l41/such_a_powerful_tool/?ref_source=embed&amp;ref=share&amp;embed=true" sandbox="allow-scripts allow-same-origin allow-popups" style="border: none;" height="413" width="640" scrolling="no"></iframe></p><h4 id="nvim&#95;terminal&#95;as&#95;<code>tmux</code>">nvim terminal as <code>tmux</code></h4><p>I haven't been using <code>tmux</code> or <code>screen</code> since they have conflicting keyboard shortcuts with command-line keyboard shortcuts.</p><p>When I needed to split a window and open a new session I could do it with iTerm2 shortcuts. This has downsides but worked okay for me.</p><p>With nvim you can use terminals with customized mappings. Also, it's much easier to search, move around, and copy terminal outputs within nvim terminals.</p><h4 id="git">Git</h4><p>I've been using <a href='https://github.com/jonas/tig'>tig</a> and the command-line git client with lots of shell aliases and functions.</p><p>This time I tried using <a href='https://github.com/tpope/vim-fugitive'>vim-fugitive</a> with <a href='https://github.com/tpope/vim-rhubarb'>vim-rhubarb</a>, <a href='https://github.com/rhysd/git-messenger.vim'>git-messenger</a>, <a href='https://github.com/junegunn/gv.vim'>gv</a>, fzf (again), and <a href='https://github.com/mhinz/vim-signify'>vim-signify</a>. It took a long time to set things up and get used to them but now the old ways feel ancient.</p><h3 id="next&#95;steps">Next Steps</h3><p>A long time ago I tried using vim as an IDE for Java but was failed due to a lack of features. I don't write Java these days but I use nvim for Scala, Clojure, Python, Lua, and vimscript. I'm a fan of IntelliJ but it feels too slow after getting used to nvim.</p><p>A few months ago I found <a href='https://github.com/tree-sitter/tree-sitter'>tree-sitter</a> but didn’t use it since it was in the development stage and I had to build it myself to use it. When I checked it out again a few weeks ago, it was ready to be used and plugins are developed using tree-sitter such as <a href='https://github.com/narutoxy/dim.lua'>dim</a>.</p><p>Things are being developed rapidly and awesome plugins continuously show up.</p><p><a href='https://neovim.io/charter/'>Turning vim into an IDE is not the goal of Neovim</a> but it is quickly evolving into the best IDE for vim users.</p>
</div>
    <section class="icons">
        <div class="container">
            <div class="content">
                <a href="//github.com/sangdol" target="_blank" rel="noopener"><img class="icon" src="/img/github.svg" alt="github" /></a>
                <a href="//stackoverflow.com/users/524588/sanghyun-lee" target="_blank" rel="noopener"><img class="icon" src="/img/stackoverflow.svg" alt="stackoverflow" /></a>
                <a href="//twitter.com/iamsangcom" target="_blank" rel="noopener"><img class="icon" src="/img/twitter.svg" alt="twitter" /></a>
                <a href="//linkedin.com/in/sanghyun-lee-b1129151" target="_blank" rel="noopener"><img class="icon" src="/img/linkedin.svg" alt="linkedin" /></a>
                <a href="mailto:hammerha+iamsang-en@gmail.com"><img class="icon" src="/img/email.svg" alt="email" /></a>
            </div>
        </div>
    </section>
</body>
</html>
